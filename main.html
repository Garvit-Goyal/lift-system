<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lift System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #578cc5 0%, #1155a3 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .tab-btn.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .elevator-system {
            display: grid;
            grid-template-columns: 1fr 300px 1fr;
            gap: 30px;
            align-items: start;
        }

        .building {
            background: #2c3e50;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .floor {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: #34495e;
            border-radius: 10px;
            position: relative;
            transition: all 0.3s ease;
        }

        .floor:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .floor-number {
            width: 40px;
            height: 40px;
            background: #3498db;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .elevator-shaft {
            flex: 1;
            height: 40px;
            background: #1a252f;
            border-radius: 20px;
            position: relative;
            margin: 0 15px;
            overflow: hidden;
        }

        .elevator-car {
            width: 35px;
            height: 35px;
            background: linear-gradient(45deg, #f1c40f, #f39c12);
            border-radius: 5px;
            position: absolute;
            top: 2.5px;
            left: 2.5px;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .floor-buttons {
            display: flex;
            gap: 10px;
        }

        .floor-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .up-btn {
            background: #27ae60;
            color: white;
        }

        .down-btn {
            background: #e74c3c;
            color: white;
        }

        .floor-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .floor-btn.active {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .control-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .control-panel h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
            font-size: 1.5rem;
        }

        .elevator-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 25px;
        }

        .floor-select-btn {
            padding: 15px;
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .floor-select-btn:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
        }

        .floor-select-btn.selected {
            background: #2ecc71;
            color: white;
            border-color: #27ae60;
        }

        .status-display {
            background: #34495e;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #4a5f7a;
        }

        .status-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .queue-display {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .queue-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .admin-panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .admin-panel h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .control-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .emergency-btn {
            background: #e74c3c;
            color: white;
        }

        .emergency-btn:hover {
            background: #c0392b;
        }

        .maintenance-btn {
            background: #f39c12;
            color: white;
        }

        .maintenance-btn:hover {
            background: #e67e22;
        }

        .reset-btn {
            background: #27ae60;
            color: white;
        }

        .reset-btn:hover {
            background: #2ecc71;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .emergency-mode {
            background: #e74c3c !important;
            animation: emergencyFlash 1s infinite alternate;
        }

        @keyframes emergencyFlash {
            0% {
                opacity: 0.8;
            }

            100% {
                opacity: 1;
            }
        }

        .maintenance-mode {
            background: #f39c12 !important;
            opacity: 0.7;
        }

        @media (max-width: 768px) {
            .elevator-system {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Lift Management System</h1>
        </div>

        <div class="tab-container">
            <button class="tab-btn active" onclick="switchTab('user')">üë§ User Interface</button>
            <button class="tab-btn" onclick="switchTab('admin')">‚öôÔ∏è Admin Dashboard</button>
        </div>

        <div id="user-tab" class="tab-content active">
            <div class="elevator-system">
                <div class="building" id="building">
                    <!-- Floors will be generated by JavaScript -->
                </div>

                <div class="control-panel">
                    <h3>üéõÔ∏è Floor Selection</h3>
                    <div class="elevator-grid" id="floorButtons">
                        <!-- Floor buttons will be generated -->
                    </div>

                    <div class="status-display">
                        <div class="status-item">
                            <span>Current Floor:</span>
                            <span id="currentFloor">1</span>
                        </div>
                        <div class="status-item">
                            <span>Status:</span>
                            <span id="elevatorStatus">Idle</span>
                        </div>
                        <div class="status-item">
                            <span>Direction:</span>
                            <span id="direction">Stopped</span>
                        </div>
                        <div class="status-item">
                            <span>Current Speed:</span>
                            <span id="currentSpeed">0 floors/min</span>
                        </div>
                        <div class="status-item">
                            <span>Est. Wait Time:</span>
                            <span id="waitTime">0s</span>
                        </div>
                        <div class="status-item">
                            <span>Queue Length:</span>
                            <span id="queueLength">0</span>
                        </div>
                    </div>

                    <div class="queue-display">
                        <h4>üéØ Request Queue</h4>
                        <div id="queueList"></div>
                    </div>
                </div>

                <div class="building">
                    <div style="text-align: center; color: white; margin-bottom: 20px;">
                        <h3>üìä Building Status</h3>
                    </div>
                    <div id="buildingInfo" style="color: white; font-size: 14px;">
                        <!-- Building info will be populated -->
                    </div>
                </div>
            </div>
        </div>

        <div id="admin-tab" class="tab-content">
            <div class="admin-controls">
                <div class="admin-panel">
                    <h3>üö® Emergency Controls</h3>
                    <button class="control-btn emergency-btn" onclick="toggleEmergency()">
                        <span id="emergencyText">ACTIVATE EMERGENCY</span>
                    </button>
                    <button class="control-btn maintenance-btn" onclick="toggleMaintenance()">
                        <span id="maintenanceText">ENTER MAINTENANCE</span>
                    </button>
                    <button class="control-btn reset-btn" onclick="resetSystem()">RESET SYSTEM</button>
                </div>

                <div class="admin-panel">
                    <h3>üìà System Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="stat-number" id="totalTrips">0</span>
                            <span class="stat-label">Total Trips</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number" id="avgWaitTime">0s</span>
                            <span class="stat-label">Avg Wait Time</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number" id="systemUptime">0m</span>
                            <span class="stat-label">Uptime</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-number" id="energyUsage">0 kW</span>
                            <span class="stat-label">Energy Usage</span>
                        </div>
                    </div>
                </div>

                <div class="admin-panel">
                    <h3>Lift Configuration</h3>
                    <div style="margin-bottom: 15px;">
                        <label for="speedSlider">Elevator Speed:</label>
                        <input type="range" id="speedSlider" min="500" max="3000" value="1000"
                            oninput="updateSpeedPreview(this.value)">
                        <span id="speedValue">1.0x</span>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label for="floorsInput">Number of Floors:</label>
                        <input type="number" id="floorsInput" min="5" max="20" value="10"
                            oninput="updateFloorsPreview(this.value)">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <div id="configPreview" style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 12px; color: #666; display: none;">
                            Changes pending - click Apply to confirm
                        </div>
                    </div>
                    <button class="control-btn reset-btn" id="applyConfigBtn" onclick="applyConfiguration()"
                        style="display: none;">
                        APPLY CONFIGURATION
                    </button>
                </div>

                <div class="admin-panel">
                    <h3>üìã Recent Activity</h3>
                    <div id="systemLogs"
                        style="height: 200px; overflow-y: auto; background: #f8f9fa; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px;">
                        <!-- Logs will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class ElevatorSystem {
            constructor() {
                this.currentFloor = 1;
                this.targetFloor = 1;
                this.isMoving = false;
                this.direction = 'stopped';
                this.queue = [];
                this.floors = 10;
                this.speed = 1000; // milliseconds per floor
                this.isEmergency = false;
                this.isMaintenance = false;
                this.stats = {
                    totalTrips: 0,
                    totalWaitTime: 0,
                    requestCount: 0,
                    startTime: Date.now(),
                    energyUsage: 0
                };
                this.floorRequests = new Set();
                this.logs = [];
                this.requestTimes = new Map(); // Track when requests were made
                this.currentSpeedFPM = 0; // Current speed in floors per minute

                this.init();
                this.startStatsUpdate();
                this.startSpeedTracking();
            }

            init() {
                this.generateBuilding();
                this.generateFloorButtons();
                this.updateDisplay();
                this.log('System initialized');
            }

            generateBuilding() {
                const building = document.getElementById('building');
                building.innerHTML = '';

                for (let floor = this.floors; floor >= 1; floor--) {
                    const floorDiv = document.createElement('div');
                    floorDiv.className = 'floor';
                    floorDiv.innerHTML = `
                        <div class="floor-number">${floor}</div>
                        <div class="elevator-shaft">
                            ${floor === this.currentFloor ? '<div class="elevator-car">üè¢</div>' : ''}
                        </div>
                        <div class="floor-buttons">
                            ${floor < this.floors ? '<button class="floor-btn up-btn" onclick="elevator.callElevator(' + floor + ', \'up\')">‚Üë</button>' : ''}
                            ${floor > 1 ? '<button class="floor-btn down-btn" onclick="elevator.callElevator(' + floor + ', \'down\')">‚Üì</button>' : ''}
                        </div>
                    `;
                    building.appendChild(floorDiv);
                }
            }

            generateFloorButtons() {
                const container = document.getElementById('floorButtons');
                container.innerHTML = '';

                for (let floor = 1; floor <= this.floors; floor++) {
                    const button = document.createElement('button');
                    button.className = 'floor-select-btn';
                    button.textContent = floor;
                    button.onclick = () => this.requestFloor(floor);
                    container.appendChild(button);
                }
            }

            callElevator(floor, direction) {
                if (this.isEmergency) {
                    this.log(`Emergency mode: Call from floor ${floor} ignored`);
                    return;
                }

                this.log(`Call from floor ${floor} (${direction})`);
                this.addToQueue(floor);
            }

            requestFloor(floor) {
                if (this.isEmergency) {
                    this.log(`Emergency mode: Floor ${floor} request ignored`);
                    return;
                }

                this.log(`Floor ${floor} requested`);
                this.addToQueue(floor);

                // Visual feedback
                const buttons = document.querySelectorAll('.floor-select-btn');
                buttons[floor - 1].classList.add('selected');
                setTimeout(() => buttons[floor - 1].classList.remove('selected'), 500);
            }

            addToQueue(floor) {
                if (!this.queue.includes(floor) && floor !== this.currentFloor) {
                    this.queue.push(floor);
                    this.floorRequests.add(floor);
                    this.requestTimes.set(floor, Date.now()); // Track request time
                    this.stats.requestCount++;
                    this.processQueue();
                }
                this.updateDisplay();
            }

            processQueue() {
                if (this.isMoving || this.queue.length === 0 || this.isEmergency || this.isMaintenance) {
                    return;
                }

                // Sort queue based on current direction and position
                this.queue.sort((a, b) => {
                    if (this.direction === 'up' || this.direction === 'stopped') {
                        return a - b;
                    } else {
                        return b - a;
                    }
                });

                const nextFloor = this.queue[0];
                this.moveToFloor(nextFloor);
            }

            moveToFloor(targetFloor) {
                if (this.currentFloor === targetFloor) {
                    return;
                }

                this.isMoving = true;
                this.targetFloor = targetFloor;
                this.direction = targetFloor > this.currentFloor ? 'up' : 'down';

                this.log(`Moving ${this.direction} to floor ${targetFloor}`);

                const floorsToMove = Math.abs(targetFloor - this.currentFloor);
                const totalTime = floorsToMove * this.speed;

                // Update energy usage
                this.stats.energyUsage += floorsToMove * 0.5;

                // Animate elevator movement
                this.animateElevator(totalTime);

                setTimeout(() => {
                    this.currentFloor = targetFloor;
                    this.queue = this.queue.filter(floor => floor !== targetFloor);
                    this.floorRequests.delete(targetFloor);

                    // Calculate wait time for this request
                    if (this.requestTimes.has(targetFloor)) {
                        const waitTime = Date.now() - this.requestTimes.get(targetFloor);
                        this.stats.totalWaitTime += waitTime;
                        this.requestTimes.delete(targetFloor);
                    }

                    this.isMoving = false;
                    this.currentSpeedFPM = 0; // Stop speed tracking
                    this.stats.totalTrips++;

                    this.log(`Arrived at floor ${targetFloor}`);

                    // Brief pause at floor
                    setTimeout(() => {
                        if (this.queue.length > 0) {
                            this.processQueue();
                        } else {
                            this.direction = 'stopped';
                        }
                        this.updateDisplay();
                    }, 1000);

                    this.updateDisplay();
                }, totalTime);
            }

            animateElevator(duration) {
                const startFloor = this.currentFloor;
                const endFloor = this.targetFloor;
                const startTime = Date.now();

                const animate = () => {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);

                    const currentPos = startFloor + (endFloor - startFloor) * progress;
                    this.updateElevatorPosition(currentPos);

                    if (progress < 1) {
                        requestAnimationFrame(animate);
                    }
                };

                animate();
            }

            updateElevatorPosition(floor) {
                const elevatorCars = document.querySelectorAll('.elevator-car');
                elevatorCars.forEach(car => car.remove());

                const floors = document.querySelectorAll('.floor');
                const floorIndex = this.floors - Math.round(floor);

                if (floors[floorIndex]) {
                    const shaft = floors[floorIndex].querySelector('.elevator-shaft');
                    const car = document.createElement('div');
                    car.className = 'elevator-car';
                    car.textContent = 'üè¢';
                    shaft.appendChild(car);
                }
            }

            updateDisplay() {
                document.getElementById('currentFloor').textContent = this.currentFloor;
                document.getElementById('elevatorStatus').textContent =
                    this.isEmergency ? 'EMERGENCY' :
                        this.isMaintenance ? 'MAINTENANCE' :
                            this.isMoving ? 'Moving' : 'Idle';
                document.getElementById('direction').textContent =
                    this.direction.charAt(0).toUpperCase() + this.direction.slice(1);
                document.getElementById('queueLength').textContent = this.queue.length;

                // Update current speed display
                document.getElementById('currentSpeed').textContent =
                    this.isMoving ? `${this.currentSpeedFPM} floors/min` : '0 floors/min';

                // Calculate and display estimated wait time
                const estimatedWait = this.calculateEstimatedWaitTime();
                document.getElementById('waitTime').textContent = estimatedWait + 's';

                // Update queue display
                const queueList = document.getElementById('queueList');
                queueList.innerHTML = this.queue.length === 0 ?
                    '<div style="color: #666; font-style: italic;">No pending requests</div>' :
                    this.queue.map((floor, index) => {
                        const waitingSince = this.requestTimes.has(floor) ?
                            Math.floor((Date.now() - this.requestTimes.get(floor)) / 1000) : 0;
                        return `<div class="queue-item">Floor ${floor} <span style="color: #666; font-size: 12px;">(waiting ${waitingSince}s)</span></div>`;
                    }).join('');

                // Update building info
                const buildingInfo = document.getElementById('buildingInfo');
                buildingInfo.innerHTML = `
                    <div style="margin-bottom: 10px;">üè¢ Floors: ${this.floors}</div>
                    <div style="margin-bottom: 10px;">‚ö° Speed: ${(2000 - this.speed) / 1000}x</div>
                    <div style="margin-bottom: 10px;">üéØ Active Requests: ${this.floorRequests.size}</div>
                    <div style="margin-bottom: 10px;">üìä Total Trips: ${this.stats.totalTrips}</div>
                    <div>üîã Energy: ${this.stats.energyUsage.toFixed(1)} kW</div>
                `;

                // Update floor button states
                const floorButtons = document.querySelectorAll('.floor-btn');
                floorButtons.forEach(btn => {
                    btn.classList.toggle('active',
                        this.floorRequests.has(parseInt(btn.textContent)) ||
                        this.queue.includes(parseInt(btn.textContent))
                    );
                });
            }

            toggleEmergency() {
                this.isEmergency = !this.isEmergency;
                const emergencyText = document.getElementById('emergencyText');
                const elevatorCar = document.querySelector('.elevator-car');

                if (this.isEmergency) {
                    emergencyText.textContent = 'DEACTIVATE EMERGENCY';
                    this.queue = [];
                    this.floorRequests.clear();
                    this.isMoving = false;
                    this.direction = 'stopped';
                    if (elevatorCar) elevatorCar.classList.add('emergency-mode');
                    this.log('EMERGENCY MODE ACTIVATED');
                } else {
                    emergencyText.textContent = 'ACTIVATE EMERGENCY';
                    if (elevatorCar) elevatorCar.classList.remove('emergency-mode');
                    this.log('Emergency mode deactivated');
                }

                this.updateDisplay();
            }

            toggleMaintenance() {
                this.isMaintenance = !this.isMaintenance;
                const maintenanceText = document.getElementById('maintenanceText');
                const elevatorCar = document.querySelector('.elevator-car');

                if (this.isMaintenance) {
                    maintenanceText.textContent = 'EXIT MAINTENANCE';
                    this.queue = [];
                    this.floorRequests.clear();
                    this.isMoving = false;
                    this.direction = 'stopped';
                    if (elevatorCar) elevatorCar.classList.add('maintenance-mode');
                    this.log('Maintenance mode activated');
                } else {
                    maintenanceText.textContent = 'ENTER MAINTENANCE';
                    if (elevatorCar) elevatorCar.classList.remove('maintenance-mode');
                    this.log('Maintenance mode deactivated');
                }

                this.updateDisplay();
            }

            resetSystem() {
                this.currentFloor = 1;
                this.targetFloor = 1;
                this.isMoving = false;
                this.direction = 'stopped';
                this.queue = [];
                this.floorRequests.clear();
                this.requestTimes.clear(); // Clear request times
                this.currentSpeedFPM = 0;
                this.isEmergency = false;
                this.isMaintenance = false;
                this.stats = {
                    totalTrips: 0,
                    totalWaitTime: 0,
                    requestCount: 0,
                    startTime: Date.now(),
                    energyUsage: 0
                };

                document.getElementById('emergencyText').textContent = 'ACTIVATE EMERGENCY';
                document.getElementById('maintenanceText').textContent = 'ENTER MAINTENANCE';

                this.generateBuilding();
                this.updateDisplay();
                this.log('System reset completed');
            }

            updateSpeed(value) {
                this.speed = 3500 - parseInt(value);
                const speedMultiplier = ((3000 - parseInt(value)) / 1000).toFixed(1);
                document.getElementById('speedValue').textContent = speedMultiplier + 'x';
                this.log(`Speed updated to ${speedMultiplier}x`);
            }

            updateFloors(value) {
                const newFloors = parseInt(value);
                if (newFloors >= 5 && newFloors <= 20) {
                    this.floors = newFloors;
                    this.resetSystem();
                    this.log(`Building updated to ${newFloors} floors`);
                }
            }

            startStatsUpdate() {
                setInterval(() => {
                    const uptime = Math.floor((Date.now() - this.stats.startTime) / 60000);
                    const avgWait = this.stats.requestCount > 0 ?
                        Math.floor(this.stats.totalWaitTime / this.stats.requestCount / 1000) : 0;

                    document.getElementById('totalTrips').textContent = this.stats.totalTrips;
                    document.getElementById('avgWaitTime').textContent = avgWait + 's';
                    document.getElementById('systemUptime').textContent = uptime + 'm';
                    document.getElementById('energyUsage').textContent = this.stats.energyUsage.toFixed(1) + ' kW';
                }, 1000);
            }

            startSpeedTracking() {
                setInterval(() => {
                    if (this.isMoving) {
                        // Calculate floors per minute based on current speed setting
                        this.currentSpeedFPM = Math.round(60000 / this.speed);
                    } else {
                        this.currentSpeedFPM = 0;
                    }
                    this.updateDisplay();
                }, 500); // Update every 500ms for smooth display
            }

            calculateEstimatedWaitTime() {
                if (this.queue.length === 0 || this.isEmergency || this.isMaintenance) {
                    return 0;
                }

                let totalTime = 0;
                let currentPos = this.currentFloor;

                // If currently moving, add remaining time to reach target
                if (this.isMoving) {
                    const remainingFloors = Math.abs(this.targetFloor - this.currentFloor);
                    totalTime += remainingFloors * (this.speed / 1000);
                    currentPos = this.targetFloor;
                }

                // Calculate time to serve all requests in queue
                const sortedQueue = [...this.queue].sort((a, b) => {
                    if (this.direction === 'up' || this.direction === 'stopped') {
                        return a - b;
                    } else {
                        return b - a;
                    }
                });

                for (const floor of sortedQueue) {
                    const distance = Math.abs(floor - currentPos);
                    totalTime += distance * (this.speed / 1000);
                    totalTime += 1; // 1 second stop time per floor
                    currentPos = floor;
                }

                return Math.round(totalTime);
            }

            log(message) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = `[${timestamp}] ${message}`;
                this.logs.unshift(logEntry);

                if (this.logs.length > 50) {
                    this.logs = this.logs.slice(0, 50);
                }

                const logsContainer = document.getElementById('systemLogs');
                if (logsContainer) {
                    logsContainer.innerHTML = this.logs.join('<br>');
                    logsContainer.scrollTop = 0;
                }
            }
        }

        // Tab switching functionality
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        // Initialize elevator system
        const elevator = new ElevatorSystem();

        // Configuration management
        let pendingConfig = {
            speed: 1000,
            floors: 10,
            hasChanges: false
        };

        function updateSpeedPreview(value) {
            const speedMultiplier = ((3000 - parseInt(value)) / 1000).toFixed(1);
            document.getElementById('speedValue').textContent = speedMultiplier + 'x';

            pendingConfig.speed = 3500 - parseInt(value);
            pendingConfig.hasChanges = true;
            showConfigPreview();
        }

        function updateFloorsPreview(value) {
            const floors = parseInt(value);
            if (floors >= 5 && floors <= 20) {
                pendingConfig.floors = floors;
                pendingConfig.hasChanges = true;
                showConfigPreview();
            }
        }

        function showConfigPreview() {
            const preview = document.getElementById('configPreview');
            const applyBtn = document.getElementById('applyConfigBtn');

            if (pendingConfig.hasChanges) {
                const speedMultiplier = ((3500 - pendingConfig.speed) / 1000).toFixed(1);
                preview.innerHTML = `
                    <strong>Pending Changes:</strong><br>
                    ‚Ä¢ Speed: ${speedMultiplier}x<br>
                    ‚Ä¢ Floors: ${pendingConfig.floors}<br>
                    <em>Click Apply to confirm changes</em>
                `;
                preview.style.display = 'block';
                applyBtn.style.display = 'block';
            } else {
                preview.style.display = 'none';
                applyBtn.style.display = 'none';
            }
        }

        function applyConfiguration() {
            if (pendingConfig.hasChanges) {
                // Apply speed change
                elevator.speed = pendingConfig.speed;
                const speedMultiplier = ((3500 - pendingConfig.speed) / 1000).toFixed(1);
                elevator.log(`Speed updated to ${speedMultiplier}x`);

                // Apply floors change if different
                if (pendingConfig.floors !== elevator.floors) {
                    elevator.floors = pendingConfig.floors;
                    elevator.resetSystem();
                    elevator.log(`Building updated to ${pendingConfig.floors} floors`);
                }

                // Reset pending changes
                pendingConfig.hasChanges = false;
                showConfigPreview();

                // Show confirmation
                const preview = document.getElementById('configPreview');
                preview.innerHTML = '<strong style="color: #27ae60;">‚úÖ Configuration applied successfully!</strong>';
                preview.style.display = 'block';

                setTimeout(() => {
                    preview.style.display = 'none';
                }, 3000);
            }
        }
    </script>
</body>

</html>